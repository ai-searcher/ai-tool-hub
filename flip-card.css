/* ═══════════════════════════════════════════════════════════
   FLIP CARD SYSTEM - PREMIUM (MOBILE FIXED POSITION)
   - nutzt DEINE Styles aus style.css (Badge/Title/Marquee bleiben wie vorn)
   - Rückseite: hochwertig, passt zum Neural-Design (Rating-Bar statt ⭐)
   - Flip bleibt auf EXACT gleicher Position (kein Layout-Jump)
   - Mobile: bleibt 2-spaltig, Card wächst nur leicht (kein Fullscreen)
   ══════════════════════════════════════════════════════════ */


/* =========================
   CARD BASE (nur Flip-Teil)
   ========================= */

.card-square {
  /* WICHTIG: NICHT ändern, übernimmt dein Grid/Layout */
  position: relative;
  transform-style: preserve-3d;
  will-change: transform;
  /* damit absolute Faces NICHT das Layout beeinflussen */
  contain: layout paint style;
}

/* Faces (Front & Back) */
.card-face {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  border-radius: inherit;
  overflow: hidden;

  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;

  transform-style: preserve-3d;
  -webkit-transform-style: preserve-3d;
}

/* Front bleibt exakt wie vorher (dein vorhandener Inhalt) */
.card-face-front {
  z-index: 2;
  transform: rotateY(0deg);
}

/* Back face: Premium Glass + Neural Look */
.card-face-back {
  z-index: 1;
  transform: rotateY(180deg);

  /* Premium background (passt zu deiner Seite) */
  background:
    radial-gradient(circle at 20% 15%, rgba(0, 243, 255, 0.10) 0%, transparent 45%),
    radial-gradient(circle at 80% 85%, rgba(124, 77, 255, 0.10) 0%, transparent 50%),
    linear-gradient(135deg, rgba(26, 30, 55, 0.98) 0%, rgba(15, 18, 42, 0.98) 55%, rgba(20, 24, 50, 0.98) 100%);
  backdrop-filter: blur(26px) saturate(170%);
  -webkit-backdrop-filter: blur(26px) saturate(170%);

  border: 2px solid rgba(0, 243, 255, 0.22);
  box-shadow:
    0 0 0 2px rgba(0, 243, 255, 0.12),
    0 18px 48px rgba(0, 0, 0, 0.60),
    0 0 60px rgba(0, 243, 255, 0.10);

  /* Layout */
  padding: 44px 16px 16px 16px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  overflow: hidden;
}

/* Flip Animation (bleibt am Platz) */
.card-square {
  transition: transform 520ms cubic-bezier(.2,.9,.2,1);
  transform-origin: 50% 50%;
}

.card-square.is-flipped {
  /* Perspektive direkt am Element, damit nichts "springt" */
  transform: perspective(1200px) rotateY(180deg) scale(1.05);
  z-index: 150;
}

/* Optional: wenn du “Hover Lift” aus style.css hast, soll es NICHT reinfunken wenn flipped */
.card-square.is-flipped:hover {
  transform: perspective(1200px) rotateY(180deg) scale(1.05);
}


/* =========================
   DIM OTHER CARDS
   ========================= */

.tool-grid-squares:has(.card-square.is-flipped) .card-square:not(.is-flipped) {
  opacity: 0.30;
  filter: blur(2px) saturate(0.9);
  transition: opacity 240ms ease, filter 240ms ease;
  pointer-events: none;
}

.tool-grid-squares:has(.card-square.is-flipped) .card-square.is-flipped {
  opacity: 1;
  filter: none;
  pointer-events: auto;
}


/* =========================
   BACK FACE UI (Premium)
   ========================= */

/* Close Button */
.card-back-close {
  position: absolute;
  top: 10px;
  left: 10px;
  width: 34px;
  height: 34px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.18);
  background: rgba(255,255,255,0.06);
  color: rgba(255,255,255,0.90);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  line-height: 1;
  cursor: pointer;
  z-index: 5;
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  transition: transform 180ms ease, background 180ms ease, border-color 180ms ease;
}
.card-back-close:active { transform: scale(0.95); }
@media (hover:hover) and (pointer:fine) {
  .card-back-close:hover {
    background: rgba(255,255,255,0.10);
    border-color: rgba(255,255,255,0.28);
  }
}

/* Category Badge
   WICHTIG: übernimmt die Farben aus style.css via data-category Regeln,
   weil dein style.css bereits .card-square[data-category="..."] .square-category-badge färbt.
   Wir reusen dafür exakt DIE Badge-Optik */
.card-back-category {
  /* gleiche “Pill” wie vorn */
  display: inline-flex;
  align-items: center;
  justify-content: center;

  font-size: 0.75rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.08em;

  padding: 5px 12px;
  border-radius: 16px;

  /* Default fallback (wird durch category rules weiter unten überschrieben) */
  color: var(--primary);
  background: var(--primary-dim);

  /* Position oben rechts wie bei deinem Wunsch */
  position: absolute;
  top: 10px;
  right: 10px;

  z-index: 5;
}

/* Title (nimmt Typo-Farben aus style.css) */
.card-face-back .card-back-title {
  margin-top: 6px;
  font-size: 1.05rem;
  font-weight: 800;
  letter-spacing: -0.02em;
  color: var(--text-primary);
  line-height: 1.15;

  /* clamp für mobile */
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Description */
.card-back-description {
  font-size: 0.82rem;
  line-height: 1.45;
  color: rgba(224, 224, 240, 0.86);

  /* bleibt sauber */
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
  opacity: 0.95;
}

/* Rating block */
.card-back-rating {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-top: 2px;
}

.card-back-rating-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
}

.card-back-rating-label {
  font-size: 0.72rem;
  color: rgba(160, 160, 176, 1);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  font-weight: 700;
}

.card-back-rating-value {
  font-size: 0.95rem;
  font-weight: 800;
  color: var(--primary);
  text-shadow: 0 0 14px rgba(0, 243, 255, 0.18);
}

/* Neural Rating Bar */
.card-back-rating-bar {
  position: relative;
  height: 10px;
  border-radius: 999px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.10);
  overflow: hidden;
}

.card-back-rating-fill {
  height: 100%;
  width: 50%;
  border-radius: 999px;

  /* “Neural line” gradient */
  background: linear-gradient(
    90deg,
    rgba(0,243,255,0.95) 0%,
    rgba(124,77,255,0.85) 55%,
    rgba(0,243,255,0.95) 100%
  );

  box-shadow:
    0 0 18px rgba(0, 243, 255, 0.20),
    0 0 28px rgba(124, 77, 255, 0.12);

  position: relative;
}

/* Animated shimmer */
.card-back-rating-fill::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.22) 50%, transparent 100%);
  transform: translateX(-70%);
  animation: neuralShimmer 2.6s ease-in-out infinite;
  opacity: 0.35;
}

@keyframes neuralShimmer {
  0%   { transform: translateX(-80%); }
  50%  { transform: translateX(80%); }
  100% { transform: translateX(80%); }
}

/* Actions */
.card-back-actions {
  margin-top: auto;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  padding-top: 10px;
  border-top: 1px solid rgba(255,255,255,0.06);
}

/* CTA base */
.card-back-cta {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;

  height: 40px;
  border-radius: 12px;
  font-size: 0.82rem;
  font-weight: 800;
  cursor: pointer;

  text-decoration: none;
  user-select: none;
  -webkit-tap-highlight-color: transparent;

  transition: transform 180ms ease, box-shadow 180ms ease, background 180ms ease, border-color 180ms ease;
}

.card-back-cta:active { transform: scale(0.98); }

/* Primary */
.card-back-cta.primary {
  background: linear-gradient(135deg, rgba(0, 243, 255, 1) 0%, rgba(0, 212, 224, 1) 100%);
  color: #0A0E27;
  border: none;
  box-shadow: 0 8px 22px rgba(0, 243, 255, 0.22);
}
@media (hover:hover) and (pointer:fine) {
  .card-back-cta.primary:hover {
    transform: translateY(-1px);
    box-shadow: 0 12px 28px rgba(0, 243, 255, 0.30);
  }
}

/* Ghost */
.card-back-cta.ghost {
  background: rgba(255,255,255,0.06);
  border: 1.5px solid rgba(0, 243, 255, 0.22);
  color: rgba(0, 243, 255, 0.95);
}
@media (hover:hover) and (pointer:fine) {
  .card-back-cta.ghost:hover {
    background: rgba(0, 243, 255, 0.10);
    border-color: rgba(0, 243, 255, 0.35);
    transform: translateY(-1px);
  }
}


/* =========================
   CATEGORY COLORS (BACK BADGE)
   (übernimmt exakt deine Palette aus style.css)
   ========================= */

.card-square[data-category="text"]  .card-back-category { background: var(--glow-text);  color: var(--color-text); }
.card-square[data-category="image"] .card-back-category { background: var(--glow-image); color: var(--color-image); }
.card-square[data-category="code"]  .card-back-category { background: var(--glow-code);  color: var(--color-code); }
.card-square[data-category="audio"] .card-back-category { background: var(--glow-audio); color: var(--color-audio); }
.card-square[data-category="video"] .card-back-category { background: var(--glow-video); color: var(--color-video); }
.card-square[data-category="data"]  .card-back-category { background: var(--glow-data);  color: var(--color-data); }


/* =========================
   MOBILE: 2 SPALTEN BLEIBEN
   (wichtig: nichts darf 1-spaltig erzwingen)
   ========================= */

@media (max-width: 767px) {
  /* bleibt 2-spaltig */
  #tool-grid.tool-grid-squares,
  .tool-grid.tool-grid-squares,
  .tool-grid-squares {
    grid-template-columns: repeat(2, 1fr) !important;
    align-items: start;
  }

  /* Flip scaling minimal */
  .card-square.is-flipped {
    transform: perspective(1100px) rotateY(180deg) scale(1.03);
  }

  /* Back padding kompakter */
  .card-face-back {
    padding: 40px 14px 14px 14px;
  }

  .card-face-back .card-back-title {
    font-size: 0.96rem;
  }

  .card-back-description {
    font-size: 0.78rem;
    -webkit-line-clamp: 3;
  }

  .card-back-actions {
    gap: 8px;
  }

  .card-back-cta {
    height: 38px;
    font-size: 0.78rem;
    border-radius: 12px;
  }
}


/* =========================
   ACCESSIBILITY / REDUCED MOTION
   ========================= */

@media (prefers-reduced-motion: reduce) {
  .card-square {
    transition-duration: 0.01ms !important;
  }
  .card-back-rating-fill::after {
    animation: none !important;
  }
}

/* Fokus sichtbar */
.card-square:focus-visible,
.card-back-close:focus-visible,
.card-back-cta:focus-visible {
  outline: 2px solid rgba(0, 243, 255, 0.55);
  outline-offset: 2px;
}